#!/bin/sh

##
## This startup file is automatically generated by tools/scripts/createScript.pl
##

mysql_stop()
{
    if [ "${started_mysql}" = "true" ]; then
        ${METC_HOME}/sql/stop_mysql.sh
    fi
    exit $1
}

trap mysql_stop EXIT INT TERM

. "$(dirname $0)/../../setEnv.sh"

APPLICATION_DIR=ors

started_mysql=true

cd ${METC_HOME}/mysql
./bin/mysqladmin --verbose --host=${MYSQL_HOST} --port=${MYSQL_PORT} --user=root --password=${MYSQL_ROOT_PASSWORD} status > /dev/null 2>&1
if [ $? -ne 0 ]; then
    ${METC_HOME}/sql/start_mysql.sh
    if [ $? -ne 0 ]; then
        exit 1
    fi
else
    started_mysql=false
fi

cd ${METC_HOME}/${APPLICATION_DIR}

THE_CLASSPATH=./conf
for file in `ls -1 ./lib/*.jar`
do
    THE_CLASSPATH=${THE_CLASSPATH}:${file}
done

java -Xms384m -Xmx600m -XX:MaxPermSize=512m -server -Dorg.marketcetera.appDir=${METC_HOME}/${APPLICATION_DIR}\
 -cp "${THE_CLASSPATH}"\
 org.marketcetera.ors.OrderRoutingSystem $*
